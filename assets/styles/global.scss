// /* Import the rest of Bulma */
@import "bulma/bulma";
@import "bulma-o-steps/bulma-steps.css";
@import "@creativebulma/bulma-tooltip";

// Table column alignment for consistent two-column tables
.table.two-column-labels tbody tr td:first-child {
  width: 40%;
  min-width: 226px;
  white-space: nowrap;
}

.table {
  thead tr {
    background: #f8f9fa;
    
    th {
      color: #5f6368;
      font-weight: 500;
      padding: 12px 16px;
      border-bottom: 1px solid #e8eaed;
    }
  }
  
  tbody {
    tr td {
      padding: 12px 16px;
      border-bottom: 1px solid #e8eaed;
      
      &:first-child {
        color: #5f6368;
        font-weight: 500;
      }
    }
    
    tr:last-child td {
      border-bottom: none;
    }
  }
}

// Section titles
.title.is-5 {
  color: #202124;
  font-weight: 400;
}

.button {
  &.is-wide {
    min-width: 140px;
  }

  &.is-wider {
    min-width: 170px;
  }

  &.is-widest {
    min-width: 220px;
  }

  &.is-small {
    padding-top: 3px;
    padding-bottom: 3px;
  }
  &.is-text {
    text-decoration: none;
  }

  &:focus,
  &:focus-visible,
  &:active,
  &:focus:not(:active) {
    outline: none !important;
    box-shadow: none !important;
  }

  // Only apply border and background overrides to buttons without color classes
  &:not(.is-primary):not(.is-secondary):not(.is-success):not(.is-danger):not(.is-warning):not(.is-info):not(.is-light):not(.is-dark):not(.is-link) {
    &:hover,
    &:focus,
    &:focus-visible,
    &:active,
    &:focus:not(:active) {
      border-color: #dbdbdb !important;
      border-width: 1px !important;
      background-color: inherit;
    }
  }
}

// Dropdown styling
.dropdown-menu {
  .dropdown-content {
    background: white;
    border: 1px solid #e8eaed;
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    padding: 4px;
  }

  .dropdown-item {
    color: #5f6368;
    font-size: 14px;
    font-weight: 500;
    padding: 8px 12px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    
    svg {
      color: inherit;
    }
    
    img[src$=".svg"] {
      filter: invert(47%) sepia(8%) saturate(665%) hue-rotate(180deg) brightness(93%) contrast(88%);
    }
    
    &:hover {
      background: #f8f9fa;
      color: #202124;
    }
  }

  .dropdown-divider {
    background-color: #e8eaed;
    margin: 4px 0;
  }
}

.dark-mode {
  .dropdown-menu {
    .dropdown-content {
      background: #2a2a2a;
      border-color: #404040;
    }

    .dropdown-item {
      color: #e0e0e0;
      
      svg {
        color: inherit;
      }
      
      img[src$=".svg"] {
        filter: invert(88%) sepia(0%) saturate(0%) hue-rotate(180deg) brightness(100%) contrast(88%);
      }
      
      &:hover {
        background: #333333;
        color: #ffffff;
      }
    }

    .dropdown-divider {
      background-color: #404040;
    }
  }
}

// Tab button styling (used for navigation tabs and toggle buttons)
.tab-button {
  background: white;
  border: 1px solid #e8eaed;
  color: #5f6368;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s;

  &:hover {
    background: #f8f9fa;
  }

  &.is-active {
    background: #363636;
    color: white;
    border-color: #363636;
  }
}

.dark-mode .tab-button {
  background: #2a2a2a;
  border-color: #404040;
  color: #e0e0e0;

  &:hover {
    background: #333333;
  }

  &.is-active {
    background: #f5f5f5;
    color: #1a1a1a;
    border-color: #f5f5f5;
  }
}

.table.is-narrow td,
.table.is-narrow th {
  line-height: 1;
}

.box {
  position: relative;
}

.menu {
  font-family: $title-family;

  .menu-list a {
    display: flex;
    align-items: center;
  }

  .menu-list a[disabled] {
    opacity: 0.5;
  }
}

/* Extra bulma classes */
.has-radius {
  border-radius: $radius;
}

.has-radius-small {
  border-radius: $radius-small;
}

.has-radius-large {
  border-radius: $radius-large;
}

.has-limited-width {
  width: 650px;
  max-width: 100%;
}

.has-limited-width-small {
  width: 560px;
  max-width: 100%;
}

.has-limited-width-smaller {
  width: 460px;
  max-width: 100%;
}

.has-limited-width-smallest {
  width: 320px;
  max-width: 100%;
}

.has-overflow-scroll {
  overflow-y: auto;
  height: 100%;
}

.is-disabled {
  pointer-events: none;
  cursor: not-allowed;
}

::-webkit-scrollbar-track-piece {
  border-radius: 6px;
  background: transparent;
}

::-webkit-scrollbar-thumb {
  border-radius: 6px;
  background: #e4e4e4;
}

::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

@include touch {
  .has-navbar-fixed-top-mobile {
    padding-top: $navbar-height;
  }
}

:root {
  /* Buttons. */
  --swv-button-background-color: black !important;
  --swv-button-outline-color: white !important;
  --swv-button-hover-background-color: #353535 !important;
  --jse-theme-color: #353535;
}
.jse-theme-dark {
  --jse-theme-color: #353535 !important;
}

.dark-mode {
  --swv-button-background-color: black !important;
  --swv-button-outline-color: white !important;
  --swv-button-hover-background-color: #cbcbcb !important;
  // --swv-button-text-color: black !important;
  .new-badge {
    background: white !important;
    color: black !important;
  }

  .modal-card-head:not(.light-mode) {
    background-color: $black-bis;
    border-bottom-color: $grey-darker;

    .modal-card-title strong {
      color: $white !important;
    }
  }

  .modal-card-body:not(.light-mode) {
    background-color: $black-bis;
    color: $white;

    .has-text-black {
      color: $white !important;
    }

    .has-text-weight-bold {
      color: $white !important;
    }

    .button.has-background-white-ter {
      background-color: $black-ter !important;

      &:hover {
        background-color: $grey-darker !important;
        strong, .has-text-weight-bold {
          color: $secondary !important;
        }
      }

      strong, .has-text-weight-bold {
        color: $white !important;
      }
    }

    .dropdown-item {
      &:hover {
        background-color: $grey-darker;
        
        strong, .has-text-weight-bold {
          color: $secondary !important;
        }
      }

      strong, .has-text-weight-bold {
        color: $white !important;
      }
    }

    .dropdown-content {
      background-color: $black-ter;
    }

    .icon.is-medium {
      &[style*="background: black"] {
        background: white !important;
      }
    }
  }
}

.swv-button {
  font-family: inherit !important;
  font-weight: 400 !important;
  line-height: 1.1 !important;
}
.swv-button-trigger {
  border: 1px solid var(--swv-button-outline-color) !important;
}

.swv-dropdown-list {
  font-family: inherit !important;
}

.swv-modal-wrapper {
  font-family: inherit !important;
}

.tag.is-outlined {
  border: 1px solid;
}

.is-fullwidth {
  width: 100%;
}

.light-mode {
  .dark-only {
    display: none;
  }
}

.has-background-body {
  background-color: $body-background-color !important;
}

.dark-mode {
  .sidebar {
    box-shadow: 0px 6px 40px 0px rgba(255, 255, 255, 0.02) !important;
  }
  body:not(.light-mode) {
    background-color: $body-background-color-dark;
  }

  .modal-card-foot:not(.light-mode) {
    background-color: $black-bis;
    border-top-color: $grey-darker;
  }

  .modal-card-title:not(.light-mode) {
    color: $white;
  }

  .delete:not(.light-mode) {
    background-color: rgba($white, 0.2);
    &:hover {
      background-color: rgba($white, 0.3);
    }
  }

  .tag {
    // color:white !important;
    background-color: $black-ter !important;
    &:not(.is-outlined) span {
      color: white;
    }
  }

  .has-background-body:not(.light-mode) {
    background-color: $body-background-color-dark !important;
  }
  .vjs-tree-node.is-highlight,
  .vjs-tree-node:hover {
    background-color: $grey-darker;
  }
  .progress {
    // background-color: $black-ter;
    &:indeterminate {
      background-color: $black-ter;
    }
    &.is-info:indeterminate {
      background-image: linear-gradient(
        to right,
        hsl(207, 61%, 53%) 30%,
        $black-ter 30%
      );
    }
  }
  .navbar:not(.light-mode) {
    background: $black;

    .navbar-burger {
      color: $white;
    }

    &.has-shadow {
      box-shadow: 0 2px 0 0 $grey-dark;
    }
  }
  .pagination-previous,
  .pagination-next,
  .pagination-link {
    color: $white;
    &.is-current {
      color: $text;
    }
  }
  .select:not(.light-mode) select {
    background-color: $grey-darker;
    border-color: $black-ter;
    color: white;
  }
  .table:not(.light-mode) {
    color: $white;
    background-color: $black-bis;

    thead th {
      color: $white;
    }
    td,
    th {
      border-color: $grey-dark;
      color: $white;
      
      strong {
        color: $white;
      }
    }
    &.is-hoverable {
      tbody {
        tr:not(.is-selected) {
          &:hover {
            background-color: $black-ter !important;
          }
        }
      }
    }
    &.is-striped {
      tbody {
        tr:not(.is-selected) {
          &:nth-child(even) {
            background-color: darken($black-ter, 3%);
          }
        }
      }
    }
    .has-text-white {
      color: $white !important;
    }
  }

  .light-only {
    display: none;
  }

  .has-text-white:not(.light-mode) {
    color: $black !important;
  }

  .has-text-black:not(.light-mode) {
    color: $white !important;
  }

  a.has-text-black:hover:not(.light-mode) {
    color: $grey-light !important;
  }

  .has-background-white:not(.light-mode) {
    background-color: $black !important;
  }
  .has-background-light:not(.light-mode) {
    background-color: $black-ter !important;
  }

  .sidebar:not(.light-mode) {
    background-color: $black-bis !important;
  }

  .has-background-black:not(.light-mode) {
    background-color: $white !important;
  }

  .has-background-white-ter:not(.light-mode) {
    background-color: $black-ter !important;
  }

  .has-background-white-bis:not(.light-mode) {
    background-color: $black-bis !important;
  }

  .title:not(.light-mode) {
    color: white;
  }

  .box:not(.light-mode) {
    background-color: $black-bis;
    color: white;
  }

  .button:not(.light-mode) {
    &.is-dark {
      &.is-outlined {
        color: $light;
      }
    }
    &.is-text {
      color: $white;
      &:hover {
        background-color: $black-ter;
      }
    }
    &.is-primary {
      background-color: $primary-invert;
      color: $primary;

      &.is-outlined {
        background-color: transparent;
        border-color: $primary-invert;
        color: $primary-invert;

        &:hover {
          background-color: $primary-invert;
          border-color: $primary-invert;
          color: $primary;
        }
      }
    }
  }

  .input:not(.light-mode) {
    background-color: $grey-darker;
    border-color: $black-bis;
    color: white;

    &::placeholder {
      color: $grey;
    }
  }

  .menu-list:not(.light-mode) {
    a {
      color: $grey-lighter;

      &:hover {
        background-color: $grey-darker;
      }

      &.is-active {
        background-color: $white-bis;
        color: black;
      }
    }
  }

  .footer:not(.light-mode) {
    background-color: $body-background-color-dark;
    color: white;
  }

  .tabs:not(.light-mode) {
    ul {
      border-bottom: 3px solid $grey-darker;
    }
    li.is-active a {
      border-bottom-color: $grey;
      border-color: $grey;
      color: $primary-invert;
      background-color: $black-bis;
    }

    a {
      color: $grey;
      border-bottom-width: 3px;
      border-bottom-color: transparent;
      margin-bottom: -3px;

      &:hover {
        color: $grey-light;
        border-bottom-color: $grey;
        background-color: $black-ter;
      }
    }
  }
}

.address {
  -webkit-line-clamp: 1;
  -webkit-box-orient: vertical;
  display: -webkit-box;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: normal;
  word-break: break-all;
}

.status-dot {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  margin-right: 8px;
}

.dot-checking {
  background-color: $info;
  animation: pulse 1.5s infinite;
}

.dot-online {
  background-color: $success;
}

.dot-offline {
  background-color: $danger;
}

@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.5;
  }
}

.dark-mode .has-tooltip-arrow img {
  filter: invert(1);
}

.modal-card {
  width: 420px;
  max-width: 90%;
  
  &.modal-card-wide {
    width: 90%;
    max-width: 1200px;
  }
  
  &-body {
    &.modal-card-body-scrollable {
      max-height: 70vh;
      overflow-y: auto;
    }
  }
}

.modal-card-title {
  font-family: $title-family;
}

.w-100 {
  width: 100%;
}

/* Ensure modal tooltips are not covered by header */
.modal-card-head {
  overflow: visible; /* let bubbles extend over the header edge */
  position: relative;
  z-index: auto !important; /* avoid creating stacking context above tooltips */
}
.modal-card-body {
  position: relative; /* create stacking context above header */
  z-index: auto !important;
  overflow: visible !important; /* prevent clipping tooltip bubbles */
}

/* Prevent modal header/body from clipping tooltips by rendering them at viewport level */
.modal.is-active .modal-card [data-tooltip] {
  &::before,
  &::after {
    position: fixed !important;
    z-index: 1000000 !important; /* ensure above modal UI */
  }
}

/* Ensure the trigger itself participates in the higher stacking context */
.modal.is-active .modal-card .has-tooltip-arrow {
  position: relative !important;
  z-index: 2003 !important;
}

button[disabled][data-tooltip] {
  pointer-events: auto;
  &:hover {
    cursor: not-allowed;
  }
}

/* Add before dark-mode styles */
.dropdown-item {
  &:hover {
    strong, .has-text-weight-bold {
      color: $secondary !important;
    }
  }
}

/* Market indicator styles */
.market-select-indicator {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  border: 1px solid #e0e0e0;
  margin-right: 10px;
  vertical-align: middle;
}

.market-select-indicator.selected:before {
  content: "";
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background-color: $secondary;
}

/* Dropdown styles */
.dropdown {
  position: relative;
  width: 100%;

  &-content {
    max-height: none !important;
    padding: 0;
    background-color: var(--background-color, white);
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  &-item {
    padding: 0.4rem 1rem;
    display: flex;
    align-items: center;
    border-radius: 0;

    &:first-child {
      border-radius: 4px 4px 0 0;
    }

    &:last-child {
      border-radius: 0 0 4px 4px;
    }

    &:hover {
      background-color: #f5f5f5;
    }
  }

  &-trigger button {
    display: flex;
    align-items: center;
    width: 100%;
    justify-content: flex-start;
    padding: 0.5rem 1rem;
    height: auto;
  }

  &-menu {
    width: 100%;
    position: absolute;
    left: 0;
    margin-top: 2px;
  }
}

.modal-card {
  width: 360px;
  max-width: 90%;
  overflow: visible !important; /* allow tooltips to escape card bounds */

  &-body {
    overflow: visible !important;
    padding-bottom: 1rem;
  }
}

.is-borderless {
  border: none !important;
  box-shadow: none !important;
}

/* Dropdown styles */
.status-select {
  select {
    min-width: 120px;
    text-align: left;
    text-align-last: left;
    border-radius: 4px;
    border: 1px solid $grey-lighter;
    outline: none !important;
    box-shadow: none !important;
    padding-left: 12px;
    
    &:focus {
      border-color: $grey-light;
    }
    
    option {
      text-align: left;
      border: 1px solid $grey-lighter;
      border-radius: 4px;
      margin: 2px;
      padding: 4px 8px;
      
      &.has-text-success {
        color: $success !important;
        border-color: $success;
      }
      
      &.has-text-info {
        color: $info !important;
        border-color: $info;
      }
      
      &.has-text-warning {
        color: $warning !important;
        border-color: $warning;
      }
      
      &.has-text-dark {
        color: $dark !important;
        border-color: $dark;
      }

      &:hover {
        background-color: $grey-lighter;
      }
    }
  }
}

.dark-mode {
  .status-select {
    select {
      background-color: $grey-darker;
      border-color: $grey-dark;
      color: $white;

      &:focus {
        border-color: $grey;
      }

      option {
        background-color: $black-ter;
        border-color: $grey-dark;
        
        &:hover {
          background-color: $grey-darker;
        }

        &.has-text-success {
          color: $success !important;
          border-color: $success;
        }
        
        &.has-text-info {
          color: $info !important;
          border-color: $info;
        }
        
        &.has-text-warning {
          color: $warning !important;
          border-color: $warning;
        }
        
        &.has-text-dark {
          color: $white !important;
          border-color: $white;
        }
      }
    }
  }
}

/* Filter button styles */
.button-filter {
  &.button {
    &:hover,
    &:focus,
    &:active {
      background-color: inherit !important;
      border-color: inherit !important;
      color: inherit !important;
    }

    &.is-primary {
      &:hover,
      &:focus,
      &:active {
        background-color: $primary !important;
        border-color: $primary !important;
        color: $primary-invert !important;
      }
    }

    &.is-outlined {
      &:hover,
      &:focus,
      &:active {
        background-color: transparent !important;
        border-color: inherit !important;
        color: inherit !important;
      }
    }
  }
}

/* Add dark mode styles */
.dark-mode {
  .button-filter.button {
    background-color: $black !important;
    border-color: $white !important;
    color: $white !important;

    &:hover,
    &:focus,
    &.is-selected,
    &:active {
      background-color: $white !important;
      border-color: $white !important;
      color: $black !important;
    }

    &.is-primary {
      &:hover,
      &:focus,
      &:active,
      &.is-selected {
        background-color: $white !important;
        border-color: $white !important;
        color: $black !important;
      }
    }

    &.is-outlined {
      background-color: transparent !important;
      border-color: $white !important;
      color: $white !important;

      &:hover,
      &:focus,
      &:active,
      &.is-selected {
        background-color: $white !important;
        border-color: $white !important;
        color: $black !important;
      }
    }
  }
}

// Ensure all modals appear above profile dropdowns and other UI elements
.modal {
  z-index: 1001 !important;
  overflow: visible !important; /* prevent clipping inside modal container */
}

/* ==========================================================================
   Clickable Table Rows
   ========================================================================== */

.clickable-row {
  position: relative;
  cursor: pointer;
  transition: background-color 0.2s ease;

  &:hover {
    background-color: rgba(0, 0, 0, 0.02);
  }
}

.dark-mode .clickable-row:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

.clickable-row-link {
  display: block;
  color: inherit;
  text-decoration: none;

  &:hover {
    color: inherit;
  }

  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }
}

/* This is intentionally left empty. */
/* The class is used as a semantic hook in the HTML. */
.clickable-row-cell-content {
}

/* Global tooltip fixes - ensure tooltips render above and are not clipped */
[data-tooltip] {
  position: relative;
  &::before,
  &::after {
    z-index: 1002 !important; /* above .modal (1001) */
  }
  &::before {
    white-space: normal !important;
    max-width: 360px !important;
    min-width: 180px !important;
    padding: 10px 12px !important;
    line-height: 1.35 !important;
    text-align: left !important;
    border-radius: 8px !important;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18) !important;
    word-break: keep-all !important;
    overflow-wrap: anywhere !important;
    hyphens: manual !important;
  }
}

/* Global info icon styling for tooltips */
.icon.has-tooltip-arrow {
  color: #7a7a7a;
  cursor: default;
  vertical-align: middle;
  margin-left: 0.25rem;
  text-decoration: none !important;
  border-bottom: none !important;
  
  &:hover {
    color: #363636;
    text-decoration: none !important;
    border-bottom: none !important;
  }
}

.dark-mode .icon.has-tooltip-arrow {
  color: #b5b5b5;
  
  &:hover {
    color: #f5f5f5;
  }
}

/* Utility classes for consistent spacing and sizing */
.has-border-bottom {
  border-bottom: 1px solid #dbdbdb;
}

.dark-mode .has-border-bottom {
  border-bottom-color: #404040;
}

.has-min-width-250 {
  min-width: 250px;
  width: 250px;
}

.icon-16 {
  width: 16px;
  height: 16px;
}

.transform-rotate-270 {
  transform: rotate(-90deg);
}

.dropdown-arrow {
  transition: transform 0.2s ease;
  transform: rotate(90deg);
  
  &.is-rotated {
    transform: rotate(0deg);
  }
}

.has-min-height-500 {
  min-height: 500px;
}

.has-height-500 {
  height: 500px;
}

.back-button.is-ghost {
  border: none !important;
  
  &:hover,
  &:focus,
  &:active {
    background-color: transparent !important;
    border: none !important;
    box-shadow: none !important;
  }
}
